var A=a=>typeof a=='undefined',b=jQuery;A(b);jQuery(document).ready(function(){b(document).on('click','.close-popup',function(){hideEduPressPopup()});b(document).on('submit','.edupress-ajax',function(e){preventDefault(e);let _=b(this).serialize();let B=b(this).hasClass('edupress-edit-post-form');let d=b(this).find(':input[name=\'before_send_callback\']').val();let E=b(this).find(':input[name=\'success_callback\']').val();let f=b(this).find(':input[name=\'error_callback\']').val();b.ajax({url:edupress.ajax_url,data:_,dataType:'json',method:'POST',beforeSend:function(){if(window[d]!==void 0){let r=window[d]({data:_});if(!r)return!1}showEduPressLoading()},success:function(C,_b){hideEduPressLoading();clog(C);if(C.status>0)if(typeof window[E]=='undefined'){hideEduPressPopup();showEduPressStatus('success');B&&(b('tr[data-id=\''+C.payload.post_id+'\']').addClass('updated'),b('tr[data-id=\''+C.payload.post_id+'\'] td').each(function(){let k=b(this).data('key');if(!A(k)&&!A(C.payload[k]))b(this).text(C.payload[k])}))}else window[E](C,_b);else typeof window[f]=='undefined'?(showEduPressStatus('error'),hideEduPressPopup()):(window[f](C,_b))},error:function(){}})});b(document).on('change',':input[name="branch_id"]',function(){var _a=parseInt(b(this).val());if(edupress.shift_active){b(':input[name=\'shift_id\'] option').each(function(){let v=b(this).attr('value');v!==''&&b(this).remove()});if(edupress.shift_active==1)for(i in edupress.shifts){if(edupress.shifts[i]['branch_id']!==_a)continue;b(':input[name=\'shift_id\']').append(`<option value='${edupress.shifts[i]['id']}'>${edupress.shifts[i]['title']}</option>`)}}else{b(':input[name=\'class_id\'] option').each(function(){let v=b(this).attr('value');v!==''&&b(this).remove()});if(edupress.class_active==1)for(i in edupress.classes){if(edupress.classes[i]['branch_id']!==_a)continue;b(':input[name=\'class_id\']').append(`<option value='${edupress.classes[i]['id']}'>${edupress.classes[i]['title']}</option>`)}}});b(document).on('change',':input[name=\'shift_id\']',function(){let D=parseInt(b(this).val());b(':input[name=\'class_id\'] option').each(function(){let v=b(this).attr('value');v!==''&&b(this).remove()});if(edupress.class_active==1)for(i in edupress.classes){if(edupress.classes[i]['shift_id']!==D)continue;b(':input[name=\'class_id\']').append(`<option value='${edupress.classes[i]['id']}'>${edupress.classes[i]['title']}</option>`)}});b(document).on('change',':input[name=\'class_id\']',function(){let _A=parseInt(b(this).val());b(':input[name=\'section_id\'] option').each(function(){let v=b(this).attr('value');v!==''&&b(this).remove()});if(edupress.section_active==1)for(i in edupress.sections){if(edupress.sections[i]['class_id']!==_A)continue;b(':input[name=\'section_id\']').append(`<option value='${edupress.sections[i]['id']}'>${edupress.sections[i]['title']}</option>`)}});b(document).on('click','.edupress-edit-post',function(e){preventDefault(e);let _B=b(this).data('before-send-callback');let _c=b(this).data('success-callback');let _d=b(this).data('id');let _e=b(this).data('post-type');let F=`action=edupress_admin_ajax&ajax_action=getPostEditForm&post_id=${_d}&post_type=${_e}&_wpnonce=${edupress.wpnonce}`;b.ajax({url:edupress.ajax_url,data:F,dataType:'json',method:'POST',beforeSend:function(){clog(F);if(window[_B]!==void 0){let r=window[_B](F);if(!r)return!1}showEduPressLoading()},success:function(aA,aB){clog(F);hideEduPressLoading();window[_c]!==void 0?window[_c](aA,aB):showEduPressPopup(aA.data,`Update ${_e}`)},error:function(){}})});b(document).on('click','.edupress-publish-post',function(e){preventDefault(e);let aC=b(this).data('post-type');let _C=`action=edupress_admin_ajax&ajax_action=getPostPublishForm&post_type=${aC}&_wpnonce=${edupress.wpnonce}`;b.ajax({url:edupress.ajax_url,data:_C,dataType:'json',method:'POST',beforeSend:function(){clog(_C);showEduPressLoading()},success:function(aD){hideEduPressLoading();aD.status==1?showEduPressPopup(aD.data):showEduPressStatus('error')},error:function(){}})});b(document).on('click','.edupress-delete-post',function(e){preventDefault(e);let aE=b(this);let aF=b(this).data('id');let _D=`action=edupress_admin_ajax&ajax_action=deletePost&post_id=${aF}&_wpnonce=${edupress.wpnonce}`;b.ajax({url:edupress.ajax_url,data:_D,dataType:'json',method:'POST',beforeSend:function(){clog(_D);if(!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(aG){hideEduPressLoading();aG.status==1?aE.closest('tr').remove():showEduPressStatus('error')},error:function(){}})});b(document).on('click touch','.edupress-select-bulk-delete',function(){let aH=b(this).data('post-type');let s=b(`.edupress-bulk-delete-post[data-post-type='${aH}']`);s.prop('checked',b(this).prop('checked'));b('.edupress-bulk-delete-post').each(function(){b(this).prop('checked')?b(this).closest('tr').addClass('highlighted'):b(this).closest('tr').removeClass('highlighted')})});b(document).on('click touch','.edupress-bulk-delete-post',function(){b(this).prop('checked')?b(this).closest('tr').addClass('highlighted'):b(this).closest('tr').removeClass('highlighted')});b(document).on('click touch','.edupress-bulk-delete',function(){let aI=b(`:input[name='edupress-bulk-delete-post[]']:checked`);let aJ=aI.length;if(!aJ){alert('Select an item at least!');return!1}let aK=`action=edupress_admin_ajax&ajax_action=bulkDeletePost&_wpnonce=${edupress.wpnonce}`;aI.each(function(){let aL=b(this).data('id');aK+=`&post_id[]=${aL}`});b.ajax({url:edupress.ajax_url,data:aK,dataType:'json',method:'POST',beforeSend:function(){clog(aK);if(!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(aM){clog(aM);hideEduPressLoading();if(aM.status==1)for(const v of aM.posts)b(`tr[data-id='${v}']`).slideUp()},error:function(){}})});b(document).on('click','.publish-bulk-user-delete',function(){let c=b('.publish-bulk-user-delete').length;if(c==1){alert('You cannot delete all rows!');return!1}b(this).closest('tr').remove()});b(document).on('click','.publish-bulk-user-copy',function(){let aN=b(this).closest('tr');b(aN).after(aN.clone())});b(document).on('click touch','.edupress-modify-user',function(e){preventDefault(e);let aO=b(this).data('action');let aP=aO=='edit'?'showUserEditForm':'deleteUser';let aQ=b(this).data('user-id');let _E=`action=edupress_admin_ajax&ajax_action=${aP}&user_id=${aQ}&_wpnonce=${edupress.wpnonce}`;b.ajax({url:edupress.ajax_url,data:_E,dataType:'json',method:'POST',beforeSend:function(){clog(_E);showEduPressLoading()},success:function(aR){showEduPressLoading();!aR.status&&(hideEduPressLoading(),showEduPressStatus('error'))},error:function(){}})})});
