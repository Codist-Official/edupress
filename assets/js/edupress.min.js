(()=>{typeof e>"u"&&(e=jQuery);var e;typeof w>"u"&&(w=function(p){p.preventDefault(),p.stopPropagation()});var w;typeof r>"u"&&(r=function(p){console.log(p)});var r;typeof c>"u"&&(c=function(){e("body").append("<div class='edupress-loading' id='edupress-loading'><div class='lds-hourglass'></div></div>")});var c;typeof l>"u"&&(l=function(){e(".edupress-loading").remove()});var l;typeof y>"u"&&(y=function(p="success",f=2e3){let x="<div class='edupress-status-wrap' id='edupress-status-wrap'><div class='edupress-status'>"+("<img alt='"+p+"' src='"+edupress.img_dir_url+p+".png' class='status-img "+p+"'>")+"</div></div>";e("body").append(x),f>0&&setTimeout(U,f)});var y;typeof U>"u"&&(U=function(){jQuery(".edupress-status-wrap").remove()});var U;typeof g>"u"&&(g=function(p="",f=""){var v=`<div class="edupress-popup-overlay">
                                <div class='edupress-popup-wrap' id='edupress-popup-wrap'>
                                    <a href='javascript:void(0)' class='close-popup' id='edupress-popup-close'>x</a>
                                    <div class='edupress-popup'>
                                        <div class="title">${f}</div>
                                        <div class='content'>${p}</div>
                                    </div>
                                </div>
                            </div>`;e("body").append(v)});var g;typeof hideEdupressPopup>"u"&&(S=function(){e(".edupress-popup-overlay").remove()});var S;jQuery(document).ready(function(){e(".tablesorter").tablesorter(),e(document).on("click",".close-popup",function(){S()}),e(document).on("submit",".edupress-ajax",function(t){w(t);let s=e(this).serialize(),a=new URLSearchParams(s),n=e(this).hasClass("edupress-edit-post-form"),o=e(this),u=a.get("before_send_callback"),d=a.get("success_callback"),_=a.get("error_callback"),h=a.get("ajax_action")==="saveEduPressAdminSettingsForm";e.ajax({url:edupress.ajax_url,data:s,dataType:"json",method:"POST",beforeSend:function(){if(o.closest("input[type=submit],button[type=submit]").prop("disabled",!0),typeof window[u]<"u"&&!window[u]({data:s},o))return!1;c()},success:function(b,C){l(),r(b),b.status>0?typeof window[d]>"u"?(S(),y("success"),h&&window.location.reload(),n&&(e("tr[data-id='"+b.payload.post_id+"']").addClass("updated"),e("tr[data-id='"+b.payload.post_id+"'] td").each(function(){let O=e(this).data("key");typeof O<"u"&&typeof b.payload[O]<"u"&&e(this).text(b.payload[O])}))):window[d](b,C):typeof window[_]>"u"?(y("error"),S()):window[_](b,C,o)},error:function(){}})}),e(document).on("click",".edupress-ajax-link",function(t){w(t);let a=e(this).data(),n=new URLSearchParams(a),o=n.get("before_send_callback"),u=n.get("success_callback"),d=n.get("error_callback");r(`BeforeSend: ${o} Success: ${u} Error: ${d}`),a.action="edupress_admin_ajax",a._wpnonce=edupress.wpnonce,e.ajax({url:edupress.ajax_url,data:a,dataType:"JSON",method:"POST",beforeSend:function(){if(r(a),typeof window[o]<"u"&&typeof window[o]=="function"){if(!window[o]({data:a}))return!1}else c()},success:function(_,h){r(_),typeof window[u]<"u"&&typeof window[u]=="function"?window[u](_,h):(l(),_.status===1&&y("success"))},error:function(){typeof window[d]<"u"&&typeof window[d]=="function"?window[d]():(l(),y("error"))}})}),e(document).on("submit",".edupress-ajax-form",function(t){w(t);let a=e(this).serialize(),n=new URLSearchParams(a),o=e(this),u=n.get("before_send_callback"),d=n.get("success_callback"),_=n.get("error_callback");r(`BeforeSend: ${u} Success: ${d} Error: ${_}`),e.ajax({url:edupress.ajax_url,data:a,dataType:"JSON",method:"POST",beforeSend:function(){if(r(a),typeof window[u]<"u"){if(!window[u]({data:a},o))return!1}else c()},success:function(h,b){r(h),typeof window[d]<"u"?window[d](h,b,o):(l(),h.status===1&&(S(),y("success")))},error:function(){typeof window[_]<"u"&&typeof window[_]=="function"?window[_]():(l(),y("error"))},fail:function(h,b,C){h.status===500?(console.error("Server error 500:",jqXHR.responseText),alert("Internal Server Error (500). Please try again later.")):(console.error("Error:",textStatus,errorThrown),alert("An error occurred: "+textStatus))}})});function m(t){if(t=parseInt(t),edupress.shift_active==1){e(":input[name=shift_id] option").each(function(){e(this).attr("value")!==""&&e(this).remove()}),r(edupress.shifts);for(i in edupress.shifts){if(parseInt(edupress.shifts[i].branch_id)!==t)continue;let s=parseInt(k("shift_id"))===parseInt(edupress.shifts[i].id)?" selected='selected' ":"";e(":input[name=shift_id]").append(`<option value='${edupress.shifts[i].id}' ${s}>${edupress.shifts[i].title}</option>`)}}else if(edupress.class_active==1){e(":input[name=class_id] option").each(function(){e(this).attr("value")!==""&&e(this).remove()});for(i in edupress.classes){if(parseInt(edupress.classes[i].branch_id)!==t)continue;let s=parseInt(k("class_id"))===parseInt(edupress.classes[i].id)?" selected='selected":"";e(":input[name=class_id]").append(`<option value='${edupress.classes[i].id}' ${s}>${edupress.classes[i].title}</option>`)}}}function p(t){if(t=parseInt(t),e(":input[name='class_id'] option").each(function(){e(this).attr("value")!==""&&e(this).remove()}),edupress.class_active==1)for(i in edupress.classes){let a=parseInt(k("class_id"))===parseInt(edupress.classes[i].id)?" selected='selected' ":"";e(":input[name='class_id']").append(`<option value='${edupress.classes[i].id}' ${a}>${edupress.classes[i].title}</option>`)}}function f(t){if(t=parseInt(t),e(":input[name='section_id'] option").each(function(){e(this).attr("value")!==""&&e(this).remove()}),edupress.section_active==1)for(i in edupress.sections){if(parseInt(edupress.sections[i].class_id)!==t)continue;let s=parseInt(edupress.sections[i].id)===parseInt(k("section_id"))?" selected='selected' ":"";e(":input[name='section_id']").append(`<option value='${edupress.sections[i].id}' ${s}>${edupress.sections[i].title}</option>`)}}e(document).on("change",":input[name=branch_id]",function(){m(parseInt(e(this).val()))}),e(document).on("change",":input[name=shift_id]",function(){p(parseInt(e(this).val()))}),e(document).on("change",":input[name=class_id]",function(){f(parseInt(e(this).val()))});let v=k("branch_id"),x=k("shift_id"),A=k("class_id");v>0&&(edupress.shift_active==1?m(v):p(v)),x>0&&p(x),A>0&&f(A),e(":input[name='branch_id']").val()==""&&edupress.default_branch_id>0&&(e(":input[name='branch_id']").val(edupress.default_branch_id),edupress.shift_active==1?m(edupress.default_branch_id):(p(edupress.default_branch_id),f(edupress.default_branch_id))),e(document).on("click",".edupress-edit-post",function(t){w(t);let s=new URLSearchParams(e(this).data());r(s);let a=s.get("before_send_callback"),n=s.get("success_callback"),o=s.get("error_callback"),u=s.get("id"),d=s.get("post_type"),_=typeof d=="string"?"Update "+d.replace(/_/g," "):"Update",h={action:"edupress_admin_ajax",ajax_action:"getPostEditForm",post_id:u,post_type:d,_wpnonce:edupress.wpnonce};e.ajax({url:edupress.ajax_url,data:h,dataType:"json",method:"POST",beforeSend:function(){if(r(h),typeof window[a]<"u"&&window[a](h)===!1)return!1;c()},success:function(b,C){r(h),l(),typeof window[n]<"u"?window[n](b,C):g(b.data,_)},error:function(){r(h),l(),typeof window[o]<"u"?window[o](res,xhr):g(res.data,_)}})}),(()=>{let t="#base_url#";e("a").each(function(){let s=e(this).attr("href");s.indexOf(t)!==-1&&(s=s.replace(t,edupress.page_url),e(this).attr("href",s))})})(),e(document).on("click",".toggleForm",function(t){w(t),e(this).parents("div").find("form:eq(0)").toggle(),e(this).text()==="[Show]"?e(this).text("[Hide]"):e(this).text("[Show]")}),e(document).on("click",".showFormToUploadCsvToAddUsers",function(t){e(".bulk_users_csv_trigger").click()}),e(document).on("change",".bulk_users_csv_trigger",function(t){var s=e(this).prop("files"),a=new FormData;e.each(s,function(n,o){a.append("files[]",o)}),a.append("action","edupress_admin_ajax"),a.append("ajax_action","bulkUsersCsvUpload"),a.append("_wpnonce",edupress.wpnonce),e.ajax({url:edupress.ajax_url,type:"post",data:a,contentType:!1,processData:!1,dataType:"JSON",beforeSend:function(){console.log(a),c()},success:function(n){if(l(),n.status===1){let o=typeof n.success<"u"?n.success:0,u=typeof n.error<"u"?n.error:0;g(`${o} people inserted, ${u} failed!`),setTimeout(function(){S()},3e3)}}})}),e(document).on("focus",":input[name='user_search']",function(t){e(this).select()}),e(document).on("click",".edupress-publish-post",function(t){w(t);let a=`action=edupress_admin_ajax&ajax_action=getPostPublishForm&post_type=${e(this).data("post_type")}&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:a,dataType:"json",method:"POST",beforeSend:function(){r(a),c()},success:function(n){l(),n.status===1?(g(n.data),B()):y("error")},error:function(){}})}),e(document).on("change",".attendance-bulk-status",function(){let t=e(this).val();e(this).parents("form").find(':input[name="status[]"]').val(t)}),e(document).on("click touch",".getApiKey",function(t){w(t);let s=e("input[name='attendance_token']").val(),a=`action=edupress_admin_ajax&ajax_action=getApiKey&&_wpnonce=${edupress.wpnonce}&token=${s}`;e.ajax({url:edupress.ajax_url,data:a,method:"POST",dataType:"JSON",beforeSend:function(){if(r(a),!confirm("Are you sure to generate a new API Key?"))return!1;c()},success:function(n){l(),r(n),n.status===1&&e("input[name='attendance_api_key']").val(n.api_key)},error:function(n,o){}})}),e(document).on("click",".generate_attendance_ids",function(t){w(t);let s=`action=edupress_admin_ajax&ajax_action=generateAttendanceIdForUsers&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:s,dataType:"json",method:"POST",beforeSend:function(){r(s),c()},success:function(a){r(a),l(),a.status===1&&y("success")}})}),e(document).on("click",".edupress-delete-post",function(t){w(t);let s=e(".edupress-delete-post").length,a=e(this),n=e(this).data("id"),o=e(this).data("post-type"),u=`action=edupress_admin_ajax&ajax_action=deletePost&post_id=${n}&post_type=${o}&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:u,dataType:"json",method:"POST",beforeSend:function(){if(r(u),s===1)return alert("Sorry! You cannot delete this item."),!1;if(!confirm("Are you sure to delete?"))return!1;c()},success:function(d){l(),d.status===1?a.closest("tr").remove():y("error")},error:function(){}})}),e(document).on("click touch",".edupress-bulk-select-all",function(){let t=e(".edupress-bulk-select-item");t.prop("checked",e(this).prop("checked")),t.each(function(){e(this).prop("checked")?e(this).closest("tr").addClass("highlighted"):e(this).closest("tr").removeClass("highlighted")})}),e(document).on("click touch change",".edupress-bulk-select-item",function(){e(this).prop("checked")?e(this).closest("tr").addClass("highlighted"):e(this).closest("tr").removeClass("highlighted")}),e(document).on("click touch",".edupress-bulk-delete",function(){let t=e(":input[name='edupress-bulk-delete-post[]']:checked");if(!t.length)return alert("Select an item at least!"),!1;let a=`action=edupress_admin_ajax&ajax_action=bulkDeletePost&_wpnonce=${edupress.wpnonce}`,n;t.each(function(){let o=e(this).data("id");a+=`&post_id[]=${o}`,n=e(this).data("post-type")}),a+=`&post_type=${n}`,e.ajax({url:edupress.ajax_url,data:a,dataType:"json",method:"POST",beforeSend:function(){if(r(a),!confirm("Are you sure to delete?"))return!1;c()},success:function(o){r(o),l(),o.status===1&&o.posts.forEach((u,d)=>{e(`tr[data-id='${u}']`).slideUp()})},error:function(){}})}),e(document).on("click",".publish-bulk-user-delete",function(){if(e(".publish-bulk-user-delete").length===1)return alert("You cannot delete all rows!"),!1;e(this).closest("tr").remove()}),e(document).on("click",".publish-bulk-user-copy",function(){let t=e(this).closest("tr"),s=t.clone();e(t).after(s)}),e(document).on("click touch",".edupress-modify-user",function(t){w(t);let s=e(this).data("action"),a=s==="edit"?"showUserEditForm":"deleteUser",n=e(this).data("user-id"),o=e(this),u=`action=edupress_admin_ajax&ajax_action=${a}&user_id=${n}&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:u,dataType:"json",method:"POST",beforeSend:function(){if(r(u),s==="delete"&&!confirm("Are you sure to delete?"))return!1;c()},success:function(d){l(),d.status?s==="delete"?o.closest("tr").remove():g(d.data,"Update User"):y("error")},error:function(){}})}),e(document).on("change",".edupress-result-absent-status",function(){parseInt(e(this).val())===1?(e(this).parents("td").find(":input[type='number']").val(0),e(this).parents("td").find(":input[type='number']").prop("readonly",!0)):(e(this).parents("td").find(":input[type='number']").prop("readonly",!1),e(this).parents("td").find(":input[type='number']").val(""),e(this).parents("td").find(":input[type='number']").focus())}),e(document).on("change",".edupress-result-form thead tr:first input[type='number']",function(){let t=e(this).val(),s=e(this).data("mark-head");e(":input[name='"+s+"[]']").each(function(){e(this).attr("max",t)})}),e(document).on("change",".edupress-result-form table tbody tr :input[type='number']",function(){e(".edupress-result-form table tr").each(function(){let t=0;e(this).find('input[type="number"]').each(function(){t+=parseInt(e(this).val())||0}),e(this).find(".edupress-value-container").text(t)})}),e(document).on("change",":input[name='send_to']",function(){let t=e(this).val(),s=e(".form-row.branch_id,.form-row.shift_id,.form-row.class_id,.form-row.section_id,.form-row.role,.form-row.status");t==="users"?s.show():s.hide()}),e(document).on("change keyup kewdown",":input[name=mobile_numbers]",function(){var t=e(this).val(),s=t.split(`
`).filter(function(a){return a.trim()!==""});e(".total_numbers").text(s.length)}),e(document).on("change keyup keydown",":input[name=sms_text]",function(){var t=e(this).val().length,s=Math.ceil(t/159);e(".sms_len").text(t),e(".sms_count").text(s);var a=parseInt(e(".total_numbers").text()),n=edupress.sms_rate*a*s;e(".sms_rate").text(edupress.sms_rate),e(".sms_cost").text(n)}),e(document).on("change",".sms-compose-user-select",function(){let t=e(this).is(":checked");e(this).parents("li").find(":input[type=checkbox]").prop("checked",t)}),e(document).on("click touch",".copy-grade-table-row",function(){let t=e(this).closest("li"),s=t.find(":input[name='range_end[]']").val(),a=parseInt(s)+1||0,n=t.clone();n.find(":input").val(""),n.find(":input[name='range_start[]']").val(a),t.after(n)}),e(document).on("click touch",".remove-grade-table-row",function(){if(e(this).parents("ul").find("li").length===1)return alert("You cannot delete all rows!"),!1;confirm("Are you sure to delete?")&&e(this).closest("li").remove()}),e(document).on("click",".copy-transaction-row",function(){let t=e(this).closest("li"),s=t.clone();s.find(":input[name='fee_type[]'],:input[name='fee_amount[]']").val(""),s.find(":input[name='fee_due[]']").val(0),t.after(s)}),e(document).on("click",".remove-transaction-row",function(){let t=e(this).closest("li");if(e(this).parents("ul").find("li").length===1)return alert("Sorry! You cannot delete all rows."),!1;t.remove(),I(),R()}),e(document).on("change keyup keydown",".edupress-publish-transaction .fee_amount, .edupress-edit-transaction .fee_amount",function(){I()}),e(document).on("change keyup keydown",".discount_type,.discount_amount,:input[name='fee_amount[]']",function(t){I(),R()});let I=()=>{let t=0;e(".edupress-publish-transaction .fee_amount, .edupress-edit-transaction .fee_amount").each(function(){let s=parseFloat(e(this).val());(s==""||isNaN(s))&&(s=0),t+=s}),isNaN(t)&&(t=0),e("input[name=amount]").val(t),e(".gross_amount").val(t)},R=()=>{let t=parseFloat(e(".gross_amount").val());isNaN(t)&&(t=0);let s=e(":input[name=discount_type]").val(),a=parseFloat(e(".discount_amount").val());(isNaN(a)||a=="")&&(a=0);let n=0,o=t;a>0&&(s==="percentage"?(e(".discount_amount").attr("max",100),n=t*a/100,console.log("discount",n),o=t-n):s==="fixed"&&(o=parseFloat(t-a))),(isNaN(o)||o<0)&&(o=0),o=o.toFixed(2),e(".t_amount").val(o)};e(".edupress-filter-list .t_user").length>0&&e(".edupress-filter-list :input.t_user").autocomplete({minLength:3,source:function(t,s){let a=e(":input[name=branch_id]").val();e.ajax({url:edupress.ajax_url,data:{action:"edupress_admin_ajax",ajax_action:"getTransactionUserDetails",term:t.term,_wpnonce:edupress.wpnonce,branch_id:a},dataType:"json",method:"POST",beforeSend:function(){if(a==="")return alert("Please select a branch first!"),!1},success:function(n){s(n)},error:function(){}})},select:function(t,s){let a=s.item.key;e(this).parents("form").find(".t_user_id").val(a)},change:function(){},close:function(){},open:function(){}}),e(document).on("click touch",".result-bulk-sms-send",function(){let t=e(":input[name='student_id[]']"),s=[];t.each(function(){e(this).prop("checked")&&s.push(e(this).val())});let a={action:"edupress_admin_ajax",ajax_action:"sendResultSmsToBulkUsers",_wpnonce:edupress.wpnonce,student_ids:s,sms_data:edupress.sms_data};e.ajax({url:edupress.ajax_url,data:a,dataType:"json",method:"POST",beforeSend:function(){if(r(a),s.length===0)return alert("You must select at least one student."),!1;if(!confirm("Are you sure to select SMS?"))return!1;c()},success:function(n){r(n),l(),y(n.status?"success":"error"),e(".edupress-bulk-select-all, .edupress-bulk-select-item").prop("checked",!1)}})}),e(document).on("click touch",".result-bulk-print",function(t){let s=e(this).data("rank-method"),a=e(":input[name='student_id[]']"),n=e(this).data("term-id"),o=e(this).data("start-date"),u=e(this).data("end-date"),d=[],_=e(this);a.each(function(){e(this).prop("checked")&&d.push(e(this).val())});let h={action:"edupress_admin_ajax",ajax_action:"printBulkResult",_wpnonce:edupress.wpnonce,student_ids:d,method:s,subject_order:edupress.subject_order,term_id:n,start_date:o,end_date:u,data:edupress.result_data};e.ajax({url:edupress.ajax_url,data:h,dataType:"json",method:"POST",beforeSend:function(){if(r(h),d.length===0)return alert("You must select at least one student."),!1;if(!confirm("Are you sure to print results?"))return!1;c()},success:function(b){r(b),e(".edupress-bulk-select-all").click(),l(),printContent(b.data)}})}),e(document).on("change",":input[name='unregistered[]']",function(t){let s=parseInt(e(this).val()),a=e(this);s===1?(e(this).parents("tr").find(":input").each(function(){e(this).hasClass("edupress-result-unregistered-status")||(e(this).hasClass("edupress-result-absent-status")&&e(this).val(1),e(this).attr("type")!=="hidden"&&e(this).val(0),e(this).prop("readonly",!0))}),e(this).parents("tr").find(".edupress-value-container").text(0)):e(this).parents("tr").find(":input").each(function(){e(this).hasClass("edupress-result-unregistered-status")||(e(this).hasClass("edupress-result-absent-status")&&e(this).val(0),e(this).attr("type")!=="hidden"&&e(this).val(0),e(this).prop("readonly",!1))})}),e(document).on("change","#mobileMenu",function(){window.location.href=e(this).val()}),e(document).on("click",".printIndividualResult",function(t){let s=e(this).data("user-id"),a=e(this).data("term-id"),n=e(this).data("start-date"),o=e(this).data("end-date"),u=e(this).data("rank-method"),d={_wpnonce:edupress.wpnonce,action:"edupress_admin_ajax",ajax_action:"printIndividualResult",user_id:s,rank_method:u,term_id:a,start_date:n,end_date:o,subject_order:edupress.subject_order,class_data:edupress.class_data,data:edupress.result_data[s]};e.ajax({url:edupress.ajax_url,data:d,dataType:"JSON",method:"POST",beforeSend:function(){r(d),c()},success:function(_,h){r(_),l(),printContent(_.data)}})}),e(document).on("click",".edupress-bulk-update-users",function(t){let s=e(".edupress-bulk-select-item:checked"),a=[];e(".edupress-bulk-select-item:checked").each(function(){a.push(e(this).val())});let n=`action=edupress_admin_ajax&ajax_action=showBulkUserUpdateScreen&_wpnonce=${edupress.wpnonce}&users=${a.join(",")}`;e.ajax({url:edupress.ajax_url,data:n,dataType:"json",method:"POST",beforeSend:function(){if(s.length===0)return alert("Please select an item first!"),!1;r(n),c()},success:function(o){l(),r(o),o.status===1&&g(o.data)}})}),e(document).on("click","#delete_sms_logs",function(t){w(t);let s=e("#sms_delete_start").val(),a=e("#sms_delete_end").val();if(s===""||a==="")return alert("Please select both dates!"),!1;let n=`action=edupress_admin_ajax&ajax_action=deleteSmsLogs&start_date=${s}&end_date=${a}&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:n,dataType:"json",method:"POST",beforeSend:function(){r(n),c()},success:function(o){r(o),l()}})}),e(document).on("click",".sms-attendance-summary",function(t){let s=e(":input[name='user_id[]']:checked").map(function(){return this.value}).get(),a=s.join(","),n={action:"edupress_admin_ajax",ajax_action:"smsAttendanceSummaryReport",_wpnonce:edupress.wpnonce,users:a,attendance_data:edupress.summary_json};e.ajax({url:edupress.ajax_url,data:n,dataType:"JSON",method:"POST",beforeSend:function(){if(r(n),s.length===0)return alert("Please select users first!"),!1;if(!confirm("Are you sure to send SMS?"))return!1;c()},success:function(o){r(o),l(),o.status===1&&y("success")}})}),e(document).on("change",".monthly_day_selector",function(t){let s=e(this).data("dayname"),a=e(this).data("month"),n=e(this).data("year"),o=e(this).is(":checked");e(`:input[name='changeDayStatus'][data-dayname='${s}'][data-month='${a}'][data-year='${n}']`).click()}),e(document).on("change","#calendarMonthSelector",function(t){let s=e(this).val();if(s.trim()==="")return!1;e(".calendar-month").hide(),e(`.calendar-month[data-my='${s}'],.cal-save-btn`).show()}),e(document).on("click touch",".process_delete_data",function(t){w(t);let s=e(":input[name='delete_data_types[]']:checked").map(function(){return e(this).val()}).get().join(","),a=e("input[name='delete_start_date']").val(),n=e("input[name='delete_end_date']").val(),o=`action=${edupress.ajax_action}&ajax_action=processDeleteData&data_types=${s}&_wpnonce=${edupress.wpnonce}&start_date=${a}&end_date=${n}`;e.ajax({url:edupress.ajax_url,data:o,dataType:"JSON",method:"POST",beforeSend:function(){if(r(o),s.length===0||a===""&&n==="")return alert("Please select data types and one of the dates!"),!1;c()},success:function(u){l(),r(u),u.status===1&&(e(".value-wrap .delete_data_stats").html(u.data),e(".delete_confirm_btn").show())}})}),e(document).on("click touch",".delete_confirm_btn",function(t){w(t);let s=e(":input[name='confirm_post_types[]']:checked").map(function(){return e(this).val()}).get().join(","),a=e("input[name='delete_start_date']").val(),n=e("input[name='delete_end_date']").val(),o=`action=${edupress.ajax_action}&ajax_action=confirmDeleteData&data_types=${s}&_wpnonce=${edupress.wpnonce}&start_date=${a}&end_date=${n}`;e.ajax({url:edupress.ajax_url,data:o,dataType:"JSON",method:"POST",beforeSend:function(){if(r(o),s.length===0||a===""&&n==="")return alert("Please select at least one item to confirm deletion!"),!1;c()},success:function(u){l(),r(u)}})});let P=null,T="table.draggable[data-post_type='subject'] tbody tr";e(document).on("dragstart",T,function(t){P=e(this),e(this).addClass("dragging"),setTimeout(()=>e(this).hide(),0)}),e(document).on("dragend",T,function(t){P=null,e(this).removeClass("dragging").show()}),e(document).on("dragover",T,function(t){t.preventDefault()}),e(document).on("drop",T,function(t){P&&(e(this).before(P),D())}),e(document).on("click",".register_attendance_device",function(t){w(t);let s=e("#attendance_device_name").val(),a=parseInt(e("#attendance_device_count").val());if(s==="")return alert("Please select device name!"),!1;if(isNaN(a)||a<1)return alert("Please select at least one device!"),!1;let n=`device_name=${s}&device_count=${a}&action=edupress_admin_ajax&ajax_action=registerDevice&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:n,dataType:"json",method:"POST",beforeSend:function(){r(n),c()},success:function(o){r(o),l(),y("success")}})});let D=()=>{let t=[],s=null;e(T).each(function(n){t.push(e(this).data("post-id")),s===null&&(s=e(this).data("post-type"))});let a=`action=edupress_admin_ajax&ajax_action=savePostOrder&post_type=${s}&order=${t}&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:a,dataType:"JSON",method:"POST",beforeSend:function(){r(a),c()},success:function(n){l(),r(n)}})};e(document).on("click",".get_default_holidays",function(t){w(t);let s=e(this).data("holidays");e("#attendance_national_holidays").val(s)}),e(document).on("change",":input[name='is_inflow']",function(t){e(this).val()=="1"?e("[name='extra_actions[]']").prop("checked",!0):e("[name='extra_actions[]']").prop("checked",!1)}),e(document).on("click",".edupress-download-id-card-pdf",function(t){w(t);let s=e(this).data("id"),a="#template_id_"+s,n=e(a).val();if(n==="")return alert("Please select a template!"),e(a).focus(),!1;let o=`action=print_material_ajax&ajax_action=downloadIdCardPdf&id=${s}&template_id=${n}&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:o,dataType:"json",beforeSend:function(){r(o),c()},success:function(u){r(u),l(),u.data.status==1?(window.open(u.data.pdf,"_blank"),g(u.data.html)):y("error")}})})});function B(){let m=e(".edupress-publish-attendance .a_user, .edupress-publish-transaction :input.user_search, .edupress-edit-transaction :input.user_search");m.length>0&&m.autocomplete({minLength:2,source:function(p,f){let v=m.parents("form").find(":input[name='branch_id']").val();e.ajax({url:edupress.ajax_url,data:{branch_id:v,action:"edupress_admin_ajax",ajax_action:"getTransactionUserDetails",term:p.term,_wpnonce:edupress.wpnonce},dataType:"json",method:"POST",beforeSend:function(){if(v==="")return alert("Please select a branch first!"),!1},success:function(x){f(x)},error:function(){}})},select:function(p,f){let v=f.item.key;e(this).parents("form").find(".t_user_id").val(v),e(this).parents("form").find(".user_id").val(v),e(this).parents("form").find(".shift_id").val(f.item.shift_id),e(this).parents("form").find(".class_id").val(f.item.class_id),e(this).parents("form").find(".section_id").val(f.item.section_id),e(".transaction-user-details").html(f.item.details)},change:function(){},close:function(){},open:function(){}})}typeof N>"u"&&(N=function(){let p=`action=edupress_admin_ajax&ajax_action=getSmsCurrentBalance&_wpnonce=${edupress.wpnonce}`;e.ajax({url:edupress.ajax_url,data:p,dataType:"json",method:"POST",beforeSend:function(){},success:function(f){f.status==1&&e(".sms-current-balance").text(f.data)},error:function(){}})});var N;function k(m){m=m.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var p=new RegExp("[\\?&]"+m+"=([^&#]*)"),f=p.exec(location.search);return f===null?"":decodeURIComponent(f[1].replace(/\+/g," "))}})();
