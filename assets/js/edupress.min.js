var A=a=>typeof a=='string',b=a=>typeof a=='undefined',_=jQuery;b(_);jQuery(document).ready(function(){_('.tablesorter').tablesorter();_(document).on('click','.close-popup',function(){hideEduPressPopup()});_(document).on('submit','.edupress-ajax',function(e){preventDefault(e);let _B=_(this).serialize();let _C=new URLSearchParams(_B);let _d=_(this).hasClass('edupress-edit-post-form');let _E=_(this);let F=_C.get('before_send_callback');let G=_C.get('success_callback');let H=_C.get('error_callback');let _i=_C.get('ajax_action')=='saveEduPressAdminSettingsForm';_.ajax({url:edupress.ajax_url,data:_B,dataType:'json',method:'POST',beforeSend:function(){_E.closest('input[type=submit],button[type=submit]').prop('disabled',!0);if(window[F]!==void 0){let r=window[F]({data:_B},_E);if(!r)return!1}showEduPressLoading()},success:function(_a,aA,aB){hideEduPressLoading();clog(_a);if(_a.status>0)if(typeof window[G]=='undefined'){hideEduPressPopup();showEduPressStatus('success');_i&&window.location.reload();_d&&(_('tr[data-id=\''+_a.payload.post_id+'\']').addClass('updated'),_('tr[data-id=\''+_a.payload.post_id+'\'] td').each(function(){let k=_(this).data('key');if(!b(k)&&!b(_a.payload[k]))_(this).text(_a.payload[k])}))}else window[G](_a,aA);else typeof window[H]=='undefined'?(showEduPressStatus('error'),hideEduPressPopup()):(window[H](_a,aA,aB))},error:function(){}})});_(document).on('click','.edupress-ajax-link',function(e){preventDefault(e);let aC=_(this);let aD=aC.data();let _D=new URLSearchParams(aD);let aE=_D.get('before_send_callback');let _f=_D.get('success_callback');let _g=_D.get('error_callback');clog(`BeforeSend: ${aE} Success: ${_f} Error: ${_g}`);aD.action='edupress_admin_ajax';aD._wpnonce=edupress.wpnonce;_.ajax({url:edupress.ajax_url,data:aD,dataType:'JSON',method:'POST',beforeSend:function(){clog(aD);if(window[aE]!==void 0&&typeof window[aE]=='function'){let r=window[aE]({data:aD});if(!r)return!1}else showEduPressLoading()},success:function(_A,aF){clog(_A);if(window[_f]!==void 0&&typeof window[_f]=='function')window[_f](_A,aF);else{hideEduPressLoading();_A.status==1&&showEduPressStatus('success')}},error:function(){window[_g]!==void 0&&typeof window[_g]=='function'?window[_g]():hideEduPressLoading()}})});_(document).on('submit','.edupress-ajax-form',function(e){preventDefault(e);let aG=_(this);let aH=aG.serialize();let aI=new URLSearchParams(aH);let aJ=aI.get('before_send_callback');let _F=aI.get('success_callback');let _G=aI.get('error_callback');clog(`BeforeSend: ${aJ} Success: ${_F} Error: ${_G}`);_.ajax({url:edupress.ajax_url,data:aH,dataType:'JSON',method:'POST',beforeSend:function(){clog(aH);if(window[aJ]!==void 0){let r=window[aJ]({data:aH},ele);if(!r)return!1}else showEduPressLoading()},success:function(aK,aL){clog(aK);if(window[_F]!==void 0)window[_F](aK,aL,ele);else{hideEduPressLoading();aK.status==1&&(hideEduPressPopup(),showEduPressStatus('success'))}},error:function(){window[_G]!==void 0&&typeof window[_G]=='function'?window[_G]():hideEduPressLoading()},fail:function(aM){aM.status==500?(console.error('Server error 500:',jqXHR.responseText),alert('Internal Server Error (500). Please try again later.')):(console.error('Error:',textStatus,errorThrown),alert(`An error occurred: ${textStatus}`))}})});function C(aN){aN=parseInt(aN);if(edupress.shift_active==1){_(':input[name=shift_id] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});clog(edupress.shifts);for(i in edupress.shifts){if(parseInt(edupress.shifts[i]['branch_id'])!==aN)continue;let aO=parseInt(E('shift_id'))==parseInt(edupress.shifts[i]['id'])?' selected=\'selected\' ':'';_(':input[name=shift_id]').append(`<option value='${edupress.shifts[i]['id']}' ${aO}>${edupress.shifts[i]['title']}</option>`)}} else if(edupress.class_active==1){_(':input[name=class_id] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});for(i in edupress.classes){if(parseInt(edupress.classes[i]['branch_id'])!==aN)continue;let aP=parseInt(E('class_id'))==parseInt(edupress.classes[i]['id'])?' selected=\'selected':'';_(':input[name=class_id]').append(`<option value='${edupress.classes[i]['id']}' ${aP}>${edupress.classes[i]['title']}</option>`)}}}function _b(aQ){aQ=parseInt(aQ);_(':input[name=\'class_id\'] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});if(edupress.class_active==1)for(i in edupress.classes){let aR=parseInt(E('class_id'));let aS=aR==parseInt(edupress.classes[i]['id'])?' selected=\'selected\' ':'';_(':input[name=\'class_id\']').append(`<option value='${edupress.classes[i]['id']}' ${aS}>${edupress.classes[i]['title']}</option>`)}}function _c(aT){aT=parseInt(aT);_(':input[name=\'section_id\'] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});if(edupress.section_active==1)for(i in edupress.sections){if(parseInt(edupress.sections[i]['class_id'])!==aT)continue;let aU=parseInt(edupress.sections[i]['id'])==parseInt(E('section_id'))?' selected=\'selected\' ':'';_(':input[name=\'section_id\']').append(`<option value='${edupress.sections[i]['id']}' ${aU}>${edupress.sections[i]['title']}</option>`)}}_(document).on('change',':input[name=branch_id]',function(){C(parseInt(_(this).val()))});_(document).on('change',':input[name=shift_id]',function(){_b(parseInt(_(this).val()))});_(document).on('change',':input[name=class_id]',function(){_c(parseInt(_(this).val()))});let D=E('branch_id');let _e=E('shift_id');let f=E('class_id');D>0&&(edupress.shift_active==1?C(D):_b(D));_e>0&&_b(_e);f>0&&_c(f);let g=_(':input[name=\'branch_id\']').val();g==''&&edupress.default_branch_id>0&&(_(':input[name=\'branch_id\']').val(edupress.default_branch_id),edupress.shift_active==1?C(edupress.default_branch_id):_b(edupress.default_branch_id));_(document).on('click','.edupress-edit-post',function(e){preventDefault(e);let aV=new URLSearchParams(_(this).data());clog(aV);let aW=aV.get('before_send_callback');let aX=aV.get('success_callback');let aY=aV.get('error_callback');let aZ=aV.get('id');let bA=aV.get('post_type');let _h=A(bA)?'Update '+bA.replace(/_/g,' '):'Update';let _I={action:'edupress_admin_ajax',ajax_action:'getPostEditForm',post_id:aZ,post_type:bA,_wpnonce:edupress.wpnonce};_.ajax({url:edupress.ajax_url,data:_I,dataType:'json',method:'POST',beforeSend:function(){clog(_I);if(window[aW]!==void 0){let r=window[aW](_I);if(!r)return!1}showEduPressLoading()},success:function(bB,bC){clog(_I);hideEduPressLoading();window[aX]!==void 0?window[aX](bB,bC):showEduPressPopup(bB.data,_h)},error:function(){clog(_I);hideEduPressLoading();window[aY]!==void 0?window[aY](res,xhr):showEduPressPopup(res.data,_h)}})});(()=>{let bD='#base_url#';_('a').each(function(){let bE=_(this).attr('href');bE.indexOf(bD)!==-1&&(bE=bE.replace(bD,edupress.page_url),_(this).attr('href',bE))})})();_(document).on('click','.toggleForm',function(e){preventDefault(e);_(this).parents('div').find('form:eq(0)').toggle();let bF=_(this).text();bF=='[Show]'?_(this).text('[Hide]'):_(this).text('[Show]')});_(document).on('click','.showFormToUploadCsvToAddUsers',function(){_('.bulk_users_csv_trigger').click()});_(document).on('change','.bulk_users_csv_trigger',function(){var bG=new FormData();_.each(_(this).prop('files'),function(i,bH){bG.append('files[]',bH)});bG.append('action','edupress_admin_ajax');bG.append('ajax_action','bulkUsersCsvUpload');bG.append('_wpnonce',edupress.wpnonce);_.ajax({url:edupress.ajax_url,type:'post',data:bG,contentType:!1,processData:!1,dataType:'JSON',beforeSend:function(){console.log(bG);showEduPressLoading()},success:function(bI){hideEduPressLoading();if(bI.status==1){let bJ=!b(bI.success)?bI.success:0;let bK=!b(bI.error)?bI.error:0;showEduPressPopup(`${bJ} people inserted, ${bK} failed!`);setTimeout(function(){hideEduPressPopup()},3000)}}})});_(document).on('focus',':input[name=\'user_search\']',function(){_(this).select()});_(document).on('click','.edupress-publish-post',function(e){preventDefault(e);let bL=_(this).data('post_type');let bM=`action=edupress_admin_ajax&ajax_action=getPostPublishForm&post_type=${bL}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:bM,dataType:'json',method:'POST',beforeSend:function(){clog(bM);showEduPressLoading()},success:function(bN){hideEduPressLoading();bN.status==1?(showEduPressPopup(bN.data),B()):(showEduPressStatus('error'))},error:function(){}})});_(document).on('change','.attendance-bulk-status',function(){_(this).parents('form').find(':input[name="status[]"]').val(_(this).val())});_(document).on('click touch','.getApiKey',function(e){preventDefault(e);let bO=_('input[name=\'attendance_token\']').val();let bP=`action=edupress_admin_ajax&ajax_action=getApiKey&&_wpnonce=${edupress.wpnonce}&token=${bO}`;_.ajax({url:edupress.ajax_url,data:bP,method:'POST',dataType:'JSON',beforeSend:function(){clog(bP);if(!confirm('Are you sure to generate a new API Key?'))return!1;showEduPressLoading()},success:function(bQ){hideEduPressLoading();clog(bQ);bQ.status==1&&_('input[name=\'attendance_api_key\']').val(bQ.api_key)},error:function(){}})});_(document).on('click','.generate_attendance_ids',function(e){preventDefault(e);let d=`action=edupress_admin_ajax&ajax_action=generateAttendanceIdForUsers&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:d,dataType:'json',method:'POST',beforeSend:function(){clog(d);showEduPressLoading()},success:function(r){clog(r);hideEduPressLoading();r.status==1&&showEduPressStatus('success')}})});_(document).on('click','.edupress-delete-post',function(e){preventDefault(e);let bR=_('.edupress-delete-post').length;let bS=_(this);let bT=_(this).data('id');let bU=_(this).data('post-type');let bV=`action=edupress_admin_ajax&ajax_action=deletePost&post_id=${bT}&post_type=${bU}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:bV,dataType:'json',method:'POST',beforeSend:function(){clog(bV);if(bR==1){alert('Sorry! You cannot delete this item.');return!1}if(!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(bW){hideEduPressLoading();bW.status==1?bS.closest('tr').remove():showEduPressStatus('error')},error:function(){}})});_(document).on('click touch','.edupress-bulk-select-all',function(){let s=_('.edupress-bulk-select-item');s.prop('checked',_(this).prop('checked'));s.each(function(){_(this).prop('checked')?_(this).closest('tr').addClass('highlighted'):_(this).closest('tr').removeClass('highlighted')})});_(document).on('click touch change','.edupress-bulk-select-item',function(){_(this).prop('checked')?_(this).closest('tr').addClass('highlighted'):_(this).closest('tr').removeClass('highlighted')});_(document).on('click touch','.edupress-bulk-delete',function(){let bX=_(`:input[name='edupress-bulk-delete-post[]']:checked`);let bY=bX.length;if(!bY){alert('Select an item at least!');return!1}let bZ=`action=edupress_admin_ajax&ajax_action=bulkDeletePost&_wpnonce=${edupress.wpnonce}`;let cA;bX.each(function(){let cB=_(this).data('id');bZ+=`&post_id[]=${cB}`;cA=_(this).data('post-type')});bZ+=`&post_type=${cA}`;_.ajax({url:edupress.ajax_url,data:bZ,dataType:'json',method:'POST',beforeSend:function(){clog(bZ);if(!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(cC){clog(cC);hideEduPressLoading();if(cC.status==1)for(const v of cC.posts)_(`tr[data-id='${v}']`).slideUp()},error:function(){}})});_(document).on('click','.publish-bulk-user-delete',function(){let c=_('.publish-bulk-user-delete').length;if(c==1){alert('You cannot delete all rows!');return!1}_(this).closest('tr').remove()});_(document).on('click','.publish-bulk-user-copy',function(){let cD=_(this).closest('tr');_(cD).after(cD.clone())});_(document).on('click touch','.edupress-modify-user',function(e){preventDefault(e);let cE=_(this).data('action');let cF=cE=='edit'?'showUserEditForm':'deleteUser';let cG=_(this).data('user-id');let cH=_(this);let cI=`action=edupress_admin_ajax&ajax_action=${cF}&user_id=${cG}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:cI,dataType:'json',method:'POST',beforeSend:function(){clog(cI);if(cE=='delete'&&!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(cJ){hideEduPressLoading();!cJ.status?showEduPressStatus('error'):cE=='delete'?cH.closest('tr').remove():showEduPressPopup(cJ.data,'Update User')},error:function(){}})});_(document).on('change','.edupress-result-absent-status',function(){let v=parseInt(_(this).val());v==1?(_(this).parents('td').find(':input[type=\'number\']').val(0),_(this).parents('td').find(':input[type=\'number\']').prop('readonly',!0)):(_(this).parents('td').find(':input[type=\'number\']').prop('readonly',!1),_(this).parents('td').find(':input[type=\'number\']').val(''),_(this).parents('td').find(':input[type=\'number\']').focus())});_(document).on('change',`.edupress-result-form thead tr:first input[type='number']`,function(){let cK=_(this).val();let cL=_(this).data('mark-head');_(`:input[name='${cL}[]']`).each(function(){_(this).attr('max',cK)})});_(document).on('change','.edupress-result-form table tbody tr :input[type=\'number\']',function(){_('.edupress-result-form table tr').each(function(){_(this).find('input[type="number"]').each(function(){total+=parseInt(_(this).val())||0});_(this).find('.edupress-value-container').text(0)})});_(document).on('change',':input[name=\'send_to\']',function(){let v=_(this).val();let cM=_('.form-row.branch_id,.form-row.shift_id,.form-row.class_id,.form-row.section_id,.form-row.role,.form-row.status');v=='users'?cM.show():cM.hide()});_(document).on('change keyup kewdown',':input[name=mobile_numbers]',function(){var cN=_(this).val(),cO=cN.split('\n').filter(cP=>cP.trim()!=='');_('.total_numbers').text(cO.length)});_(document).on('change keyup keydown',':input[name=sms_text]',function(){var cQ=_(this).val().length,cR=Math.ceil(cQ/159),cS=parseInt(_('.total_numbers').text());_('.sms_len').text(cQ);_('.sms_count').text(cR);_('.sms_rate').text(edupress.sms_rate);_('.sms_cost').text(edupress.sms_rate*cS*cR)});_(document).on('change','.sms-compose-user-select',function(){_(this).parents('li').find(':input[type=checkbox]').prop('checked',_(this).is(':checked'))});_(document).on('click touch','.copy-grade-table-row',function(){let cT=_(this).closest('li');let cU=cT.clone();cU.find(':input').val('');cU.find(':input[name=\'range_start[]\']').val(parseInt(cT.find(':input[name=\'range_end[]\']').val())+1||0);cT.after(cU)});_(document).on('click touch','.remove-grade-table-row',function(){let cV=_(this).parents('ul').find('li').length;if(cV==1){alert('You cannot delete all rows!');return!1}confirm('Are you sure to delete?')&&_(this).closest('li').remove()});_(document).on('click','.copy-transaction-row',function(){let cW=_(this).closest('li');let cX=cW.clone();cX.find(':input[name=\'fee_type[]\'],:input[name=\'fee_amount[]\']').val('');cX.find(':input[name=\'fee_due[]\']').val(0);cW.after(cX)});_(document).on('click','.remove-transaction-row',function(){let cY=_(this).closest('li');let cZ=_(this).parents('ul').find('li').length;if(cZ==1){alert('Sorry! You cannot delete all rows.');return!1}cY.remove();h();I()});_(document).on('change keyup keydown','.edupress-publish-transaction .fee_amount, .edupress-edit-transaction .fee_amount',function(){h()});_(document).on('change keyup keydown','.discount_type,.discount_amount,:input[name=\'fee_amount[]\']',function(){h();I()});var h=()=>{let dA=0;_('.edupress-publish-transaction .fee_amount, .edupress-edit-transaction .fee_amount').each(function(){let dB=parseFloat(_(this).val());dB==''||isNaN(dB)&&(dB=0);dA+=dB});isNaN(dA)&&(dA=0);_('input[name=amount]').val(dA);_('.gross_amount').val(dA)},I=()=>{let dC=parseFloat(_('.gross_amount').val());isNaN(dC)&&(dC=0);let dD=_(':input[name=discount_type]').val();let dE=parseFloat(_('.discount_amount').val());isNaN(dE)||dE==''&&(dE=0);let dF=0;let dG=dC;if(dE>0)if(dD=='percentage'){_('.discount_amount').attr('max',100);dF=dC*dE/100;console.log('discount',dF);dG=dC-dF}else dD=='fixed'&&(dG=parseFloat(dC-dE));isNaN(dG)||dG<0&&(dG=0);dG=dG.toFixed(2);_('.t_amount').val(dG)};_('.edupress-filter-list .t_user').length>0&&_('.edupress-filter-list :input.t_user').autocomplete({minLength:3,source:function(dH,dI){let dJ=_(':input[name=branch_id]').val();_.ajax({url:edupress.ajax_url,data:{'action':'edupress_admin_ajax','ajax_action':'getTransactionUserDetails','term':dH.term,'_wpnonce':edupress.wpnonce,'branch_id':dJ},dataType:'json',method:'POST',beforeSend:function(){if(dJ==''){alert('Please select a branch first!');return!1}},success:function(r){dI(r)},error:function(){}})},select:function(e,dK){_(this).parents('form').find('.t_user_id').val(dK.item.key)},change:function(){},close:function(){},open:function(){}});_(document).on('click touch','.result-bulk-sms-send',function(){let dL=_(':input[name=\'student_id[]\']');let dM=[];dL.each(function(){_(this).prop('checked')&&dM.push(_(this).val())});let dN={action:'edupress_admin_ajax',ajax_action:'sendResultSmsToBulkUsers',_wpnonce:edupress.wpnonce,student_ids:dM,sms_data:edupress.sms_data};_.ajax({url:edupress.ajax_url,data:dN,dataType:'json',method:'POST',beforeSend:function(){clog(dN);if(!dM.length){alert('You must select at least one student.');return!1}if(!confirm('Are you sure to select SMS?'))return!1;showEduPressLoading()},success:function(dO){clog(dO);hideEduPressLoading();showEduPressStatus(dO.status?'success':'error');_('.edupress-bulk-select-all, .edupress-bulk-select-item').prop('checked',!1)}})});_(document).on('click touch','.result-bulk-print',function(){let dP=_(this).data('rank-method');let dQ=_(':input[name=\'student_id[]\']');let dR=_(this).data('term-id');let dS=_(this).data('start-date');let dT=_(this).data('end-date');let dU=[];dQ.each(function(){_(this).prop('checked')&&dU.push(_(this).val())});let dV={action:'edupress_admin_ajax',ajax_action:'printBulkResult',_wpnonce:edupress.wpnonce,student_ids:dU,method:dP,subject_order:edupress.subject_order,term_id:dR,start_date:dS,end_date:dT,data:edupress.result_data};_.ajax({url:edupress.ajax_url,data:dV,dataType:'json',method:'POST',beforeSend:function(){clog(dV);if(!dU.length){alert('You must select at least one student.');return!1}if(!confirm('Are you sure to print results?'))return!1;showEduPressLoading()},success:function(dW){clog(dW);_('.edupress-bulk-select-all').click();hideEduPressLoading();printContent(dW.data)}})});_(document).on('change',`:input[name='unregistered[]']`,function(){let dX=parseInt(_(this).val());dX==1?(_(this).parents('tr').find(':input').each(function(){!_(this).hasClass('edupress-result-unregistered-status')&&(_(this).hasClass('edupress-result-absent-status')&&_(this).val(1),_(this).attr('type')!=='hidden'&&_(this).val(0),_(this).prop('readonly',!0))}),_(this).parents('tr').find('.edupress-value-container').text(0)):(_(this).parents('tr').find(':input').each(function(){!_(this).hasClass('edupress-result-unregistered-status')&&(_(this).hasClass('edupress-result-absent-status')&&_(this).val(0),_(this).attr('type')!=='hidden'&&_(this).val(0),_(this).prop('readonly',!1))}))});_(document).on('change','#mobileMenu',function(){window.location.href=_(this).val()});_(document).on('click','.printIndividualResult',function(){let dY=_(this).data('user-id');let dZ=_(this).data('term-id');let eA=_(this).data('start-date');let eB=_(this).data('end-date');let eC=_(this).data('rank-method');let eD={'_wpnonce':edupress.wpnonce,'action':'edupress_admin_ajax','ajax_action':'printIndividualResult','user_id':dY,'rank_method':eC,'term_id':dZ,'start_date':eA,'end_date':eB,'subject_order':edupress.subject_order,'class_data':edupress.class_data,'data':edupress.result_data[dY]};_.ajax({url:edupress.ajax_url,data:eD,dataType:'JSON',method:'POST',beforeSend:function(){clog(eD);showEduPressLoading()},success:function(eE){clog(eE);hideEduPressLoading();printContent(eE.data)}})});_(document).on('click','.edupress-bulk-update-users',function(){let eF=_('.edupress-bulk-select-item:checked');let eG=[];_('.edupress-bulk-select-item:checked').each(function(){eG.push(_(this).val())});let eH=`action=edupress_admin_ajax&ajax_action=showBulkUserUpdateScreen&_wpnonce=${edupress.wpnonce}&users=${eG.join(',')}`;_.ajax({url:edupress.ajax_url,data:eH,dataType:'json',method:'POST',beforeSend:function(){if(!eF.length){alert('Please select an item first!');return!1}clog(eH);showEduPressLoading()},success:function(eI){hideEduPressLoading();clog(eI);eI.status==1&&showEduPressPopup(eI.data)}})});_(document).on('click','#delete_sms_logs',function(e){preventDefault(e);let eJ=_('#sms_delete_start').val();let eK=_('#sms_delete_end').val();if(eJ==''||eK==''){alert('Please select both dates!');return!1}let eL=`action=edupress_admin_ajax&ajax_action=deleteSmsLogs&start_date=${eJ}&end_date=${eK}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:eL,dataType:'json',method:'POST',beforeSend:function(){clog(eL);showEduPressLoading()},success:function(r){clog(r);hideEduPressLoading()}})});_(document).on('click','.sms-attendance-summary',function(){let eM=_(':input[name=\'user_id[]\']:checked').map(function(){return this.value}).get();let eN=eM.join(',');let eO={action:'edupress_admin_ajax',ajax_action:'smsAttendanceSummaryReport',_wpnonce:edupress.wpnonce,users:eN,attendance_data:edupress.summary_json};_.ajax({url:edupress.ajax_url,data:eO,dataType:'JSON',method:'POST',beforeSend:function(){clog(eO);if(!eM.length){alert('Please select users first!');return!1}if(!confirm('Are you sure to send SMS?'))return!1;showEduPressLoading()},success:function(r){clog(r);hideEduPressLoading();r.status==1&&showEduPressStatus('success')}})});_(document).on('change','.monthly_day_selector',function(){let eP=_(this).data('dayname');let eQ=_(this).data('month');let eR=_(this).data('year');_(`:input[name='changeDayStatus'][data-dayname='${eP}'][data-month='${eQ}'][data-year='${eR}']`).click()});_(document).on('change','#calendarMonthSelector',function(){let v=_(this).val();if(v.trim()=='')return!1;_('.calendar-month').hide();_(`.calendar-month[data-my='${v}'],.cal-save-btn`).show()});_(document).on('click touch','.process_delete_data',function(e){preventDefault(e);let eS=_(':input[name=\'delete_data_types[]\']:checked').map(function(){return _(this).val()}).get().join(',');let eT=_('input[name=\'delete_start_date\']').val();let eU=_('input[name=\'delete_end_date\']').val();let eV=`action=${edupress.ajax_action}&ajax_action=processDeleteData&data_types=${eS}&_wpnonce=${edupress.wpnonce}&start_date=${eT}&end_date=${eU}`;_.ajax({url:edupress.ajax_url,data:eV,dataType:'JSON',method:'POST',beforeSend:function(){clog(eV);if(!eS.length||(eT==''&&eU=='')){alert('Please select data types and one of the dates!');return!1}showEduPressLoading()},success:function(r){hideEduPressLoading();clog(r);r.status==1&&(_('.value-wrap .delete_data_stats').html(r.data),_('.delete_confirm_btn').show())}})});_(document).on('click touch','.delete_confirm_btn',function(e){preventDefault(e);let eW=_(':input[name=\'confirm_post_types[]\']:checked').map(function(){return _(this).val()}).get().join(',');let eX=_('input[name=\'delete_start_date\']').val();let eY=_('input[name=\'delete_end_date\']').val();let eZ=`action=${edupress.ajax_action}&ajax_action=confirmDeleteData&data_types=${eW}&_wpnonce=${edupress.wpnonce}&start_date=${eX}&end_date=${eY}`;_.ajax({url:edupress.ajax_url,data:eZ,dataType:'JSON',method:'POST',beforeSend:function(){clog(eZ);if(!eW.length||(eX==''&&eY=='')){alert('Please select at least one item to confirm deletion!');return!1}showEduPressLoading()},success:function(r){hideEduPressLoading();clog(r)}})});let j=null;let K='table.draggable[data-post_type=\'subject\'] tbody tr';_(document).on('dragstart',K,function(){j=_(this);_(this).addClass('dragging');setTimeout(()=>_(this).hide(),0)});_(document).on('dragend',K,function(){j=null;_(this).removeClass('dragging').show()});_(document).on('dragover',K,function(e){e.preventDefault()});_(document).on('drop',K,function(){j&&(_(this).before(j),l())});_(document).on('click','.register_attendance_device',function(e){preventDefault(e);let fA=_('#attendance_device_name').val();let fB=parseInt(_('#attendance_device_count').val());if(fA==''){alert('Please select device name!');return!1}if(isNaN(fB)||fB<1){alert('Please select at least one device!');return!1}let fC=`device_name=${fA}&device_count=${fB}&action=edupress_admin_ajax&ajax_action=registerDevice&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:fC,dataType:'json',method:'POST',beforeSend:function(){clog(fC);showEduPressLoading()},success:function(fD){clog(fD);hideEduPressLoading();showEduPressStatus('success')}})});let l=()=>{let fE=[];let fF=null;_(K).each(function(){fE.push(_(this).data('post-id'));fF==null&&(fF=_(this).data('post-type'))});let fG=`action=edupress_admin_ajax&ajax_action=savePostOrder&post_type=${fF}&order=${fE}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:fG,dataType:'JSON',method:'POST',beforeSend:function(){clog(fG);showEduPressLoading()},success:function(r){hideEduPressLoading();clog(r)}})};_(document).on('click','.get_default_holidays',function(e){preventDefault(e);_('#attendance_national_holidays').val(_(this).data('holidays'))});_(document).on('change',':input[name=\'is_inflow\']',function(){let fH=!!_(this).val()=='1';fH?_('[name=\'extra_actions[]\']').prop('checked',!0):_('[name=\'extra_actions[]\']').prop('checked',!1)})});function B(){let fI=_('.edupress-publish-attendance .a_user, .edupress-publish-transaction :input.user_search, .edupress-edit-transaction :input.user_search');fI.length>0&&fI.autocomplete({minLength:2,source:function(fJ,fK){let fL=fI.parents('form').find(':input[name=\'branch_id\']').val();_.ajax({url:edupress.ajax_url,data:{'branch_id':fL,'action':'edupress_admin_ajax','ajax_action':'getTransactionUserDetails','term':fJ.term,'_wpnonce':edupress.wpnonce},dataType:'json',method:'POST',beforeSend:function(){if(fL==''){alert('Please select a branch first!');return!1}},success:function(r){fK(r)},error:function(){}})},select:function(e,fM){let fN=fM.item.key;_(this).parents('form').find('.t_user_id').val(fN);_(this).parents('form').find('.user_id').val(fN);_(this).parents('form').find('.shift_id').val(fM.item.shift_id);_(this).parents('form').find('.class_id').val(fM.item.class_id);_(this).parents('form').find('.section_id').val(fM.item.section_id);_('.transaction-user-details').html(fM.item.details)},change:function(){},close:function(){},open:function(){}})}function E(fO){fO=fO.replace(/\[/,'\\[').replace(/\]/,'\\]');var fP=RegExp(`[\?&]${fO}=([^&#]*)`),fQ=fP.exec(location.search);return fQ==null?'':decodeURIComponent(fQ[1].replace(/\+/g,' '))}
