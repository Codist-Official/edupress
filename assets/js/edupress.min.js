var A=a=>typeof a=='string',b=a=>typeof a=='undefined',_=jQuery;b(_);jQuery(document).ready(function(){_('.tablesorter').tablesorter();_(document).on('click','.close-popup',function(){hideEduPressPopup()});_(document).on('submit','.edupress-ajax',function(e){preventDefault(e);let _B=_(this).serialize();let _C=new URLSearchParams(_B);let _d=_(this).hasClass('edupress-edit-post-form');let _E=_(this);let F=_C.get('before_send_callback');let G=_C.get('success_callback');let H=_C.get('error_callback');let _i=_C.get('ajax_action')=='saveEduPressAdminSettingsForm';_.ajax({url:edupress.ajax_url,data:_B,dataType:'json',method:'POST',beforeSend:function(){_E.closest('input[type=submit],button[type=submit]').prop('disabled',!0);if(window[F]!==void 0){let r=window[F]({data:_B},_E);if(!r)return!1}showEduPressLoading()},success:function(_a,aA){hideEduPressLoading();clog(_a);if(_a.status>0)if(typeof window[G]=='undefined'){hideEduPressPopup();showEduPressStatus('success');_i&&window.location.reload();_d&&(_('tr[data-id=\''+_a.payload.post_id+'\']').addClass('updated'),_('tr[data-id=\''+_a.payload.post_id+'\'] td').each(function(){let k=_(this).data('key');if(!b(k)&&!b(_a.payload[k]))_(this).text(_a.payload[k])}))}else window[G](_a,aA);else typeof window[H]=='undefined'?(showEduPressStatus('error'),hideEduPressPopup()):(window[H](_a,aA,_E))},error:function(){}})});_(document).on('click','.edupress-ajax-link',function(e){preventDefault(e);let aB=_(this);let aC=aB.data();let _D=new URLSearchParams(aC);let aD=_D.get('before_send_callback');let _f=_D.get('success_callback');let _g=_D.get('error_callback');clog(`BeforeSend: ${aD} Success: ${_f} Error: ${_g}`);aC.action='edupress_admin_ajax';aC._wpnonce=edupress.wpnonce;_.ajax({url:edupress.ajax_url,data:aC,dataType:'JSON',method:'POST',beforeSend:function(){clog(aC);if(window[aD]!==void 0&&typeof window[aD]=='function'){let r=window[aD]({data:aC});if(!r)return!1}else showEduPressLoading()},success:function(_A,aE){clog(_A);if(window[_f]!==void 0&&typeof window[_f]=='function')window[_f](_A,aE);else{hideEduPressLoading();_A.status==1&&showEduPressStatus('success')}},error:function(){window[_g]!==void 0&&typeof window[_g]=='function'?window[_g]():hideEduPressLoading()}})});_(document).on('submit','.edupress-ajax-form',function(e){preventDefault(e);let aF=_(this);let aG=aF.serialize();let aH=new URLSearchParams(aG);let aI=_(this);let _F=aH.get('before_send_callback');let _G=aH.get('success_callback');let _h=aH.get('error_callback');clog(`BeforeSend: ${_F} Success: ${_G} Error: ${_h}`);_.ajax({url:edupress.ajax_url,data:aG,dataType:'JSON',method:'POST',beforeSend:function(){clog(aG);if(window[_F]!==void 0){let r=window[_F]({data:aG},aI);if(!r)return!1}else showEduPressLoading()},success:function(aJ,aK){clog(aJ);if(window[_G]!==void 0)window[_G](aJ,aK,aI);else{hideEduPressLoading();aJ.status==1&&(hideEduPressPopup(),showEduPressStatus('success'))}},error:function(){window[_h]!==void 0&&typeof window[_h]=='function'?window[_h]():hideEduPressLoading()},fail:function(aL){aL.status==500?(console.error('Server error 500:',jqXHR.responseText),alert('Internal Server Error (500). Please try again later.')):(console.error('Error:',textStatus,errorThrown),alert(`An error occurred: ${textStatus}`))}})});function C(aM){aM=parseInt(aM);if(edupress.shift_active==1){_(':input[name=shift_id] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});clog(edupress.shifts);for(i in edupress.shifts){if(parseInt(edupress.shifts[i]['branch_id'])!==aM)continue;let aN=parseInt(E('shift_id'))==parseInt(edupress.shifts[i]['id'])?' selected=\'selected\' ':'';_(':input[name=shift_id]').append(`<option value='${edupress.shifts[i]['id']}' ${aN}>${edupress.shifts[i]['title']}</option>`)}} else if(edupress.class_active==1){_(':input[name=class_id] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});for(i in edupress.classes){if(parseInt(edupress.classes[i]['branch_id'])!==aM)continue;let aO=parseInt(E('class_id'))==parseInt(edupress.classes[i]['id'])?' selected=\'selected':'';_(':input[name=class_id]').append(`<option value='${edupress.classes[i]['id']}' ${aO}>${edupress.classes[i]['title']}</option>`)}}}function _b(aP){aP=parseInt(aP);_(':input[name=\'class_id\'] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});if(edupress.class_active==1)for(i in edupress.classes){let aQ=parseInt(E('class_id'));let aR=aQ==parseInt(edupress.classes[i]['id'])?' selected=\'selected\' ':'';_(':input[name=\'class_id\']').append(`<option value='${edupress.classes[i]['id']}' ${aR}>${edupress.classes[i]['title']}</option>`)}}function _c(aS){aS=parseInt(aS);_(':input[name=\'section_id\'] option').each(function(){let v=_(this).attr('value');v!==''&&_(this).remove()});if(edupress.section_active==1)for(i in edupress.sections){if(parseInt(edupress.sections[i]['class_id'])!==aS)continue;let aT=parseInt(edupress.sections[i]['id'])==parseInt(E('section_id'))?' selected=\'selected\' ':'';_(':input[name=\'section_id\']').append(`<option value='${edupress.sections[i]['id']}' ${aT}>${edupress.sections[i]['title']}</option>`)}}_(document).on('change',':input[name=branch_id]',function(){C(parseInt(_(this).val()))});_(document).on('change',':input[name=shift_id]',function(){_b(parseInt(_(this).val()))});_(document).on('change',':input[name=class_id]',function(){_c(parseInt(_(this).val()))});let D=E('branch_id');let _e=E('shift_id');let f=E('class_id');D>0&&(edupress.shift_active==1?C(D):_b(D));_e>0&&_b(_e);f>0&&_c(f);let g=_(':input[name=\'branch_id\']').val();g==''&&edupress.default_branch_id>0&&(_(':input[name=\'branch_id\']').val(edupress.default_branch_id),edupress.shift_active==1?C(edupress.default_branch_id):_b(edupress.default_branch_id));_(document).on('click','.edupress-edit-post',function(e){preventDefault(e);let aU=new URLSearchParams(_(this).data());clog(aU);let aV=aU.get('before_send_callback');let aW=aU.get('success_callback');let aX=aU.get('error_callback');let aY=aU.get('id');let aZ=aU.get('post_type');let _H=A(aZ)?'Update '+aZ.replace(/_/g,' '):'Update';let _I={action:'edupress_admin_ajax',ajax_action:'getPostEditForm',post_id:aY,post_type:aZ,_wpnonce:edupress.wpnonce};_.ajax({url:edupress.ajax_url,data:_I,dataType:'json',method:'POST',beforeSend:function(){clog(_I);if(window[aV]!==void 0){let r=window[aV](_I);if(!r)return!1}showEduPressLoading()},success:function(bA,bB){clog(_I);hideEduPressLoading();window[aW]!==void 0?window[aW](bA,bB):showEduPressPopup(bA.data,_H)},error:function(){clog(_I);hideEduPressLoading();window[aX]!==void 0?window[aX](res,xhr):showEduPressPopup(res.data,_H)}})});(()=>{let bC='#base_url#';_('a').each(function(){let bD=_(this).attr('href');bD.indexOf(bC)!==-1&&(bD=bD.replace(bC,edupress.page_url),_(this).attr('href',bD))})})();_(document).on('click','.toggleForm',function(e){preventDefault(e);_(this).parents('div').find('form:eq(0)').toggle();let bE=_(this).text();bE=='[Show]'?_(this).text('[Hide]'):_(this).text('[Show]')});_(document).on('click','.showFormToUploadCsvToAddUsers',function(){_('.bulk_users_csv_trigger').click()});_(document).on('change','.bulk_users_csv_trigger',function(){var bF=new FormData();_.each(_(this).prop('files'),function(i,bG){bF.append('files[]',bG)});bF.append('action','edupress_admin_ajax');bF.append('ajax_action','bulkUsersCsvUpload');bF.append('_wpnonce',edupress.wpnonce);_.ajax({url:edupress.ajax_url,type:'post',data:bF,contentType:!1,processData:!1,dataType:'JSON',beforeSend:function(){console.log(bF);showEduPressLoading()},success:function(bH){hideEduPressLoading();if(bH.status==1){let bI=!b(bH.success)?bH.success:0;let bJ=!b(bH.error)?bH.error:0;showEduPressPopup(`${bI} people inserted, ${bJ} failed!`);setTimeout(function(){hideEduPressPopup()},3000)}}})});_(document).on('focus',':input[name=\'user_search\']',function(){_(this).select()});_(document).on('click','.edupress-publish-post',function(e){preventDefault(e);let bK=_(this).data('post_type');let bL=`action=edupress_admin_ajax&ajax_action=getPostPublishForm&post_type=${bK}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:bL,dataType:'json',method:'POST',beforeSend:function(){clog(bL);showEduPressLoading()},success:function(bM){hideEduPressLoading();bM.status==1?(showEduPressPopup(bM.data),B()):(showEduPressStatus('error'))},error:function(){}})});_(document).on('change','.attendance-bulk-status',function(){_(this).parents('form').find(':input[name="status[]"]').val(_(this).val())});_(document).on('click touch','.getApiKey',function(e){preventDefault(e);let bN=_('input[name=\'attendance_token\']').val();let bO=`action=edupress_admin_ajax&ajax_action=getApiKey&&_wpnonce=${edupress.wpnonce}&token=${bN}`;_.ajax({url:edupress.ajax_url,data:bO,method:'POST',dataType:'JSON',beforeSend:function(){clog(bO);if(!confirm('Are you sure to generate a new API Key?'))return!1;showEduPressLoading()},success:function(bP){hideEduPressLoading();clog(bP);bP.status==1&&_('input[name=\'attendance_api_key\']').val(bP.api_key)},error:function(){}})});_(document).on('click','.generate_attendance_ids',function(e){preventDefault(e);let d=`action=edupress_admin_ajax&ajax_action=generateAttendanceIdForUsers&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:d,dataType:'json',method:'POST',beforeSend:function(){clog(d);showEduPressLoading()},success:function(r){clog(r);hideEduPressLoading();r.status==1&&showEduPressStatus('success')}})});_(document).on('click','.edupress-delete-post',function(e){preventDefault(e);let bQ=_('.edupress-delete-post').length;let bR=_(this);let bS=_(this).data('id');let bT=_(this).data('post-type');let bU=`action=edupress_admin_ajax&ajax_action=deletePost&post_id=${bS}&post_type=${bT}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:bU,dataType:'json',method:'POST',beforeSend:function(){clog(bU);if(bQ==1){alert('Sorry! You cannot delete this item.');return!1}if(!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(bV){hideEduPressLoading();bV.status==1?bR.closest('tr').remove():showEduPressStatus('error')},error:function(){}})});_(document).on('click touch','.edupress-bulk-select-all',function(){let s=_('.edupress-bulk-select-item');s.prop('checked',_(this).prop('checked'));s.each(function(){_(this).prop('checked')?_(this).closest('tr').addClass('highlighted'):_(this).closest('tr').removeClass('highlighted')})});_(document).on('click touch change','.edupress-bulk-select-item',function(){_(this).prop('checked')?_(this).closest('tr').addClass('highlighted'):_(this).closest('tr').removeClass('highlighted')});_(document).on('click touch','.edupress-bulk-delete',function(){let bW=_(`:input[name='edupress-bulk-delete-post[]']:checked`);let bX=bW.length;if(!bX){alert('Select an item at least!');return!1}let bY=`action=edupress_admin_ajax&ajax_action=bulkDeletePost&_wpnonce=${edupress.wpnonce}`;let bZ;bW.each(function(){let cA=_(this).data('id');bY+=`&post_id[]=${cA}`;bZ=_(this).data('post-type')});bY+=`&post_type=${bZ}`;_.ajax({url:edupress.ajax_url,data:bY,dataType:'json',method:'POST',beforeSend:function(){clog(bY);if(!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(cB){clog(cB);hideEduPressLoading();if(cB.status==1)for(const v of cB.posts)_(`tr[data-id='${v}']`).slideUp()},error:function(){}})});_(document).on('click','.publish-bulk-user-delete',function(){let c=_('.publish-bulk-user-delete').length;if(c==1){alert('You cannot delete all rows!');return!1}_(this).closest('tr').remove()});_(document).on('click','.publish-bulk-user-copy',function(){let cC=_(this).closest('tr');_(cC).after(cC.clone())});_(document).on('click touch','.edupress-modify-user',function(e){preventDefault(e);let cD=_(this).data('action');let cE=cD=='edit'?'showUserEditForm':'deleteUser';let cF=_(this).data('user-id');let cG=_(this);let cH=`action=edupress_admin_ajax&ajax_action=${cE}&user_id=${cF}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:cH,dataType:'json',method:'POST',beforeSend:function(){clog(cH);if(cD=='delete'&&!confirm('Are you sure to delete?'))return!1;showEduPressLoading()},success:function(cI){hideEduPressLoading();!cI.status?showEduPressStatus('error'):cD=='delete'?cG.closest('tr').remove():showEduPressPopup(cI.data,'Update User')},error:function(){}})});_(document).on('change','.edupress-result-absent-status',function(){let v=parseInt(_(this).val());v==1?(_(this).parents('td').find(':input[type=\'number\']').val(0),_(this).parents('td').find(':input[type=\'number\']').prop('readonly',!0)):(_(this).parents('td').find(':input[type=\'number\']').prop('readonly',!1),_(this).parents('td').find(':input[type=\'number\']').val(''),_(this).parents('td').find(':input[type=\'number\']').focus())});_(document).on('change',`.edupress-result-form thead tr:first input[type='number']`,function(){let cJ=_(this).val();let cK=_(this).data('mark-head');_(`:input[name='${cK}[]']`).each(function(){_(this).attr('max',cJ)})});_(document).on('change','.edupress-result-form table tbody tr :input[type=\'number\']',function(){_('.edupress-result-form table tr').each(function(){_(this).find('input[type="number"]').each(function(){total+=parseInt(_(this).val())||0});_(this).find('.edupress-value-container').text(0)})});_(document).on('change',':input[name=\'send_to\']',function(){let v=_(this).val();let cL=_('.form-row.branch_id,.form-row.shift_id,.form-row.class_id,.form-row.section_id,.form-row.role,.form-row.status');v=='users'?cL.show():cL.hide()});_(document).on('change keyup kewdown',':input[name=mobile_numbers]',function(){var cM=_(this).val(),cN=cM.split('\n').filter(cO=>cO.trim()!=='');_('.total_numbers').text(cN.length)});_(document).on('change keyup keydown',':input[name=sms_text]',function(){var cP=_(this).val().length,cQ=Math.ceil(cP/159),cR=parseInt(_('.total_numbers').text());_('.sms_len').text(cP);_('.sms_count').text(cQ);_('.sms_rate').text(edupress.sms_rate);_('.sms_cost').text(edupress.sms_rate*cR*cQ)});_(document).on('change','.sms-compose-user-select',function(){_(this).parents('li').find(':input[type=checkbox]').prop('checked',_(this).is(':checked'))});_(document).on('click touch','.copy-grade-table-row',function(){let cS=_(this).closest('li');let cT=cS.clone();cT.find(':input').val('');cT.find(':input[name=\'range_start[]\']').val(parseInt(cS.find(':input[name=\'range_end[]\']').val())+1||0);cS.after(cT)});_(document).on('click touch','.remove-grade-table-row',function(){let cU=_(this).parents('ul').find('li').length;if(cU==1){alert('You cannot delete all rows!');return!1}confirm('Are you sure to delete?')&&_(this).closest('li').remove()});_(document).on('click','.copy-transaction-row',function(){let cV=_(this).closest('li');let cW=cV.clone();cW.find(':input[name=\'fee_type[]\'],:input[name=\'fee_amount[]\']').val('');cW.find(':input[name=\'fee_due[]\']').val(0);cV.after(cW)});_(document).on('click','.remove-transaction-row',function(){let cX=_(this).closest('li');let cY=_(this).parents('ul').find('li').length;if(cY==1){alert('Sorry! You cannot delete all rows.');return!1}cX.remove();h();I()});_(document).on('change keyup keydown','.edupress-publish-transaction .fee_amount, .edupress-edit-transaction .fee_amount',function(){h()});_(document).on('change keyup keydown','.discount_type,.discount_amount,:input[name=\'fee_amount[]\']',function(){h();I()});var h=()=>{let cZ=0;_('.edupress-publish-transaction .fee_amount, .edupress-edit-transaction .fee_amount').each(function(){let dA=parseFloat(_(this).val());dA==''||isNaN(dA)&&(dA=0);cZ+=dA});isNaN(cZ)&&(cZ=0);_('input[name=amount]').val(cZ);_('.gross_amount').val(cZ)},I=()=>{let dB=parseFloat(_('.gross_amount').val());isNaN(dB)&&(dB=0);let dC=_(':input[name=discount_type]').val();let dD=parseFloat(_('.discount_amount').val());isNaN(dD)||dD==''&&(dD=0);let dE=0;let dF=dB;if(dD>0)if(dC=='percentage'){_('.discount_amount').attr('max',100);dE=dB*dD/100;console.log('discount',dE);dF=dB-dE}else dC=='fixed'&&(dF=parseFloat(dB-dD));isNaN(dF)||dF<0&&(dF=0);dF=dF.toFixed(2);_('.t_amount').val(dF)};_('.edupress-filter-list .t_user').length>0&&_('.edupress-filter-list :input.t_user').autocomplete({minLength:3,source:function(dG,dH){let dI=_(':input[name=branch_id]').val();_.ajax({url:edupress.ajax_url,data:{'action':'edupress_admin_ajax','ajax_action':'getTransactionUserDetails','term':dG.term,'_wpnonce':edupress.wpnonce,'branch_id':dI},dataType:'json',method:'POST',beforeSend:function(){if(dI==''){alert('Please select a branch first!');return!1}},success:function(r){dH(r)},error:function(){}})},select:function(e,dJ){_(this).parents('form').find('.t_user_id').val(dJ.item.key)},change:function(){},close:function(){},open:function(){}});_(document).on('click touch','.result-bulk-sms-send',function(){let dK=_(':input[name=\'student_id[]\']');let dL=[];dK.each(function(){_(this).prop('checked')&&dL.push(_(this).val())});let dM={action:'edupress_admin_ajax',ajax_action:'sendResultSmsToBulkUsers',_wpnonce:edupress.wpnonce,student_ids:dL,sms_data:edupress.sms_data};_.ajax({url:edupress.ajax_url,data:dM,dataType:'json',method:'POST',beforeSend:function(){clog(dM);if(!dL.length){alert('You must select at least one student.');return!1}if(!confirm('Are you sure to select SMS?'))return!1;showEduPressLoading()},success:function(dN){clog(dN);hideEduPressLoading();showEduPressStatus(dN.status?'success':'error');_('.edupress-bulk-select-all, .edupress-bulk-select-item').prop('checked',!1)}})});_(document).on('click touch','.result-bulk-print',function(){let dO=_(this).data('rank-method');let dP=_(':input[name=\'student_id[]\']');let dQ=_(this).data('term-id');let dR=_(this).data('start-date');let dS=_(this).data('end-date');let dT=[];dP.each(function(){_(this).prop('checked')&&dT.push(_(this).val())});let dU={action:'edupress_admin_ajax',ajax_action:'printBulkResult',_wpnonce:edupress.wpnonce,student_ids:dT,method:dO,subject_order:edupress.subject_order,term_id:dQ,start_date:dR,end_date:dS,data:edupress.result_data};_.ajax({url:edupress.ajax_url,data:dU,dataType:'json',method:'POST',beforeSend:function(){clog(dU);if(!dT.length){alert('You must select at least one student.');return!1}if(!confirm('Are you sure to print results?'))return!1;showEduPressLoading()},success:function(dV){clog(dV);_('.edupress-bulk-select-all').click();hideEduPressLoading();printContent(dV.data)}})});_(document).on('change',`:input[name='unregistered[]']`,function(){let dW=parseInt(_(this).val());dW==1?(_(this).parents('tr').find(':input').each(function(){!_(this).hasClass('edupress-result-unregistered-status')&&(_(this).hasClass('edupress-result-absent-status')&&_(this).val(1),_(this).attr('type')!=='hidden'&&_(this).val(0),_(this).prop('readonly',!0))}),_(this).parents('tr').find('.edupress-value-container').text(0)):(_(this).parents('tr').find(':input').each(function(){!_(this).hasClass('edupress-result-unregistered-status')&&(_(this).hasClass('edupress-result-absent-status')&&_(this).val(0),_(this).attr('type')!=='hidden'&&_(this).val(0),_(this).prop('readonly',!1))}))});_(document).on('change','#mobileMenu',function(){window.location.href=_(this).val()});_(document).on('click','.printIndividualResult',function(){let dX=_(this).data('user-id');let dY=_(this).data('term-id');let dZ=_(this).data('start-date');let eA=_(this).data('end-date');let eB=_(this).data('rank-method');let eC={'_wpnonce':edupress.wpnonce,'action':'edupress_admin_ajax','ajax_action':'printIndividualResult','user_id':dX,'rank_method':eB,'term_id':dY,'start_date':dZ,'end_date':eA,'subject_order':edupress.subject_order,'class_data':edupress.class_data,'data':edupress.result_data[dX]};_.ajax({url:edupress.ajax_url,data:eC,dataType:'JSON',method:'POST',beforeSend:function(){clog(eC);showEduPressLoading()},success:function(eD){clog(eD);hideEduPressLoading();printContent(eD.data)}})});_(document).on('click','.edupress-bulk-update-users',function(){let eE=_('.edupress-bulk-select-item:checked');let eF=[];_('.edupress-bulk-select-item:checked').each(function(){eF.push(_(this).val())});let eG=`action=edupress_admin_ajax&ajax_action=showBulkUserUpdateScreen&_wpnonce=${edupress.wpnonce}&users=${eF.join(',')}`;_.ajax({url:edupress.ajax_url,data:eG,dataType:'json',method:'POST',beforeSend:function(){if(!eE.length){alert('Please select an item first!');return!1}clog(eG);showEduPressLoading()},success:function(eH){hideEduPressLoading();clog(eH);eH.status==1&&showEduPressPopup(eH.data)}})});_(document).on('click','#delete_sms_logs',function(e){preventDefault(e);let eI=_('#sms_delete_start').val();let eJ=_('#sms_delete_end').val();if(eI==''||eJ==''){alert('Please select both dates!');return!1}let eK=`action=edupress_admin_ajax&ajax_action=deleteSmsLogs&start_date=${eI}&end_date=${eJ}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:eK,dataType:'json',method:'POST',beforeSend:function(){clog(eK);showEduPressLoading()},success:function(r){clog(r);hideEduPressLoading()}})});_(document).on('click','.sms-attendance-summary',function(){let eL=_(':input[name=\'user_id[]\']:checked').map(function(){return this.value}).get();let eM=eL.join(',');let eN={action:'edupress_admin_ajax',ajax_action:'smsAttendanceSummaryReport',_wpnonce:edupress.wpnonce,users:eM,attendance_data:edupress.summary_json};_.ajax({url:edupress.ajax_url,data:eN,dataType:'JSON',method:'POST',beforeSend:function(){clog(eN);if(!eL.length){alert('Please select users first!');return!1}if(!confirm('Are you sure to send SMS?'))return!1;showEduPressLoading()},success:function(r){clog(r);hideEduPressLoading();r.status==1&&showEduPressStatus('success')}})});_(document).on('change','.monthly_day_selector',function(){let eO=_(this).data('dayname');let eP=_(this).data('month');let eQ=_(this).data('year');_(`:input[name='changeDayStatus'][data-dayname='${eO}'][data-month='${eP}'][data-year='${eQ}']`).click()});_(document).on('change','#calendarMonthSelector',function(){let v=_(this).val();if(v.trim()=='')return!1;_('.calendar-month').hide();_(`.calendar-month[data-my='${v}'],.cal-save-btn`).show()});_(document).on('click touch','.process_delete_data',function(e){preventDefault(e);let eR=_(':input[name=\'delete_data_types[]\']:checked').map(function(){return _(this).val()}).get().join(',');let eS=_('input[name=\'delete_start_date\']').val();let eT=_('input[name=\'delete_end_date\']').val();let eU=`action=${edupress.ajax_action}&ajax_action=processDeleteData&data_types=${eR}&_wpnonce=${edupress.wpnonce}&start_date=${eS}&end_date=${eT}`;_.ajax({url:edupress.ajax_url,data:eU,dataType:'JSON',method:'POST',beforeSend:function(){clog(eU);if(!eR.length||(eS==''&&eT=='')){alert('Please select data types and one of the dates!');return!1}showEduPressLoading()},success:function(r){hideEduPressLoading();clog(r);r.status==1&&(_('.value-wrap .delete_data_stats').html(r.data),_('.delete_confirm_btn').show())}})});_(document).on('click touch','.delete_confirm_btn',function(e){preventDefault(e);let eV=_(':input[name=\'confirm_post_types[]\']:checked').map(function(){return _(this).val()}).get().join(',');let eW=_('input[name=\'delete_start_date\']').val();let eX=_('input[name=\'delete_end_date\']').val();let eY=`action=${edupress.ajax_action}&ajax_action=confirmDeleteData&data_types=${eV}&_wpnonce=${edupress.wpnonce}&start_date=${eW}&end_date=${eX}`;_.ajax({url:edupress.ajax_url,data:eY,dataType:'JSON',method:'POST',beforeSend:function(){clog(eY);if(!eV.length||(eW==''&&eX=='')){alert('Please select at least one item to confirm deletion!');return!1}showEduPressLoading()},success:function(r){hideEduPressLoading();clog(r)}})});let j=null;let K='table.draggable[data-post_type=\'subject\'] tbody tr';_(document).on('dragstart',K,function(){j=_(this);_(this).addClass('dragging');setTimeout(()=>_(this).hide(),0)});_(document).on('dragend',K,function(){j=null;_(this).removeClass('dragging').show()});_(document).on('dragover',K,function(e){e.preventDefault()});_(document).on('drop',K,function(){j&&(_(this).before(j),l())});_(document).on('click','.register_attendance_device',function(e){preventDefault(e);let eZ=_('#attendance_device_name').val();let fA=parseInt(_('#attendance_device_count').val());if(eZ==''){alert('Please select device name!');return!1}if(isNaN(fA)||fA<1){alert('Please select at least one device!');return!1}let fB=`device_name=${eZ}&device_count=${fA}&action=edupress_admin_ajax&ajax_action=registerDevice&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:fB,dataType:'json',method:'POST',beforeSend:function(){clog(fB);showEduPressLoading()},success:function(fC){clog(fC);hideEduPressLoading();showEduPressStatus('success')}})});let l=()=>{let fD=[];let fE=null;_(K).each(function(){fD.push(_(this).data('post-id'));fE==null&&(fE=_(this).data('post-type'))});let fF=`action=edupress_admin_ajax&ajax_action=savePostOrder&post_type=${fE}&order=${fD}&_wpnonce=${edupress.wpnonce}`;_.ajax({url:edupress.ajax_url,data:fF,dataType:'JSON',method:'POST',beforeSend:function(){clog(fF);showEduPressLoading()},success:function(r){hideEduPressLoading();clog(r)}})};_(document).on('click','.get_default_holidays',function(e){preventDefault(e);_('#attendance_national_holidays').val(_(this).data('holidays'))});_(document).on('change',':input[name=\'is_inflow\']',function(){let fG=!!_(this).val()=='1';fG?_('[name=\'extra_actions[]\']').prop('checked',!0):_('[name=\'extra_actions[]\']').prop('checked',!1)})});function B(){let fH=_('.edupress-publish-attendance .a_user, .edupress-publish-transaction :input.user_search, .edupress-edit-transaction :input.user_search');fH.length>0&&fH.autocomplete({minLength:2,source:function(fI,fJ){let fK=fH.parents('form').find(':input[name=\'branch_id\']').val();_.ajax({url:edupress.ajax_url,data:{'branch_id':fK,'action':'edupress_admin_ajax','ajax_action':'getTransactionUserDetails','term':fI.term,'_wpnonce':edupress.wpnonce},dataType:'json',method:'POST',beforeSend:function(){if(fK==''){alert('Please select a branch first!');return!1}},success:function(r){fJ(r)},error:function(){}})},select:function(e,fL){let fM=fL.item.key;_(this).parents('form').find('.t_user_id').val(fM);_(this).parents('form').find('.user_id').val(fM);_(this).parents('form').find('.shift_id').val(fL.item.shift_id);_(this).parents('form').find('.class_id').val(fL.item.class_id);_(this).parents('form').find('.section_id').val(fL.item.section_id);_('.transaction-user-details').html(fL.item.details)},change:function(){},close:function(){},open:function(){}})}function E(fN){fN=fN.replace(/\[/,'\\[').replace(/\]/,'\\]');var fO=RegExp(`[\?&]${fN}=([^&#]*)`),fP=fO.exec(location.search);return fP==null?'':decodeURIComponent(fP[1].replace(/\+/g,' '))}
